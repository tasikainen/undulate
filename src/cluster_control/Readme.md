# cluster_control

This is the **cluster_control** component. The component provides an API that can be used to run `kubectl` commands against a Kubernetes cluster specified in configuration file.

## Implementation and usage

The component is implemented using the Python programming language. The API is provided by a simple adaptation of the general API file, see the Undulate documentation. Further, the API process launches the **shellog** process, implemented in `shellog.py`, which in turn launches the actual implementation using `cluster_control.py`.

The files provided as input are passed to the Kubernetes cluster using the `kubectl` tool; the command (eg. `apply` or `delete` is passed as an argument). The output generated by `kubectl` as well as the component it self is sent to the **log_data_api** component, the address of which is provided as environment variables at startup.

In order for `kubectl` to work, configuration data for the cluster must be made available. This is assumed to be found in file `k8s-cc5-default-conf`.

## Working with the cluster

For details related to running the cluster, please refer to the documentation provided by the cluster vendore.

The file `kubernetes_add_service_account_kubeconfig.sh` can be used to used to add a service account to the relevant cluster. The cluster must be running before the script can be run. After running the script, the service account created by the script must be given the relevant access rights to the cluster in order for the component to work.
